export function normalizeArabicQuantities(text: string): string {
  const replacements: Record<string, string> = {
    "\\bكيلو الا ربع\\b": "0.75 كيلو",
    "\\bاتنين كيلو و نص\\b": "2.5 كيلو",
    "\\bتلاتة كيلو و ربع\\b": "3.25 كيلو",
    "\\bكيلو و نص\\b": "1.5 كيلو",
    "\\bكيلو و ربع\\b": "1.25 كيلو",
    "\\bنص طن\\b": "0.5 طن",
    "\\bربع طن\\b": "0.25 طن",
    "\\bنص كيلو\\b": "0.5 كيلو",
    "\\bربع كيلو\\b": "0.25 كيلو",
    "\\bألف\\b": "1000",
    "\\bتسعمية\\b": "900",
    "\\bتمنمية\\b": "800",
    "\\bسبعمية\\b": "700",
    "\\bستمية\\b": "600",
    "\\bخمسمية\\b": "500",
    "\\bربعمية\\b": "400",
    "\\bتلتمية\\b": "300",
    "\\bمتين\\b": "200",
    "\\bمية\\b": "100",
    "\\bتسعين\\b": "90",
    "\\bتمنين\\b": "80",
    "\\bسبعين\\b": "70",
    "\\bستين\\b": "60",
    "\\bخمسين\\b": "50",
    "\\bاربعين\\b": "40",
    "\\bتلاتين\\b": "30",
    "\\bعشرين\\b": "20",
    "\\bتسعتاشر\\b": "19",
    "\\bتمنتاشر\\b": "18",
    "\\bسبعتاشر\\b": "17",
    "\\bستاشر\\b": "16",
    "\\bخمستاشر\\b": "15",
    "\\bاربعتاشر\\b": "14",
    "\\bتلتاشر\\b": "13",
    "\\bاتناشر\\b": "12",
    "\\bحداشر\\b": "11",
    "\\bعشرة\\b": "10",
    "\\bتسعة\\b": "9",
    "\\bتمانية\\b": "8",
    "\\bسبعة\\b": "7",
    "\\bستة\\b": "6",
    "\\bخمسة\\b": "5",
    "\\bأربع\\b": "4",
    "\\bاربع\\b": "4",
    "\\bأربعة\\b": "4",
    "\\bاربعة\\b": "4",
    "\\bثلاثة\\b": "3",
    "\\bتلاتة\\b": "3",
    "\\bاتنين\\b": "2",
    "\\bواحدة\\b": "1",
    "\\bواحد\\b": "1",
    "\\bنص\\b": "0.5",
    "(?<!ا)(?<!أ)\\bربع\\b": "0.25",
    "\\bحتتين\\b": "2",
    "\\bحتة\\b": "1",
    "\\bقطعة\\b": "piece",
    "\\bقطع\\b": "pieces",
    "\\bكجم\\b": "KG",
    "\\bكيلوجرام\\b": "KG",
    "\\bاسقاصة\\b": "متقطع",
    // Add common transcription error corrections
    "\\bرقم قطع\\b": "ورق متقطع",
    "\\bرقم قطعة\\b": "ورق متقطع",
    "\\bرقم قطعتين\\b": "ورق متقطع",
    "\\bرقم قتع\\b": "ورق متقطع",
    "\\bرقم قتعة\\b": "ورق متقطع",
    "\\bورق قطع\\b": "ورق متقطع",
    "\\bورق قطعة\\b": "ورق متقطع",
    "\\bورق قتع\\b": "ورق متقطع",
    // Fix iron translations
    "\\bمكوى\\b": "مكواة",
    "\\bمكوة\\b": "مكواة",
    "\\bمكوية\\b": "مكواة",
    "\\bمكواه\\b": "مكواة",
  };

  for (const [pattern, replacement] of Object.entries(replacements)) {
    text = text.replace(new RegExp(pattern, "g"), replacement);
  }
  return text;
}

export function normalizeArabicItemVariants(text: string): string {
  const variants: Record<string, string> = {
    "\\bبروجكتور\\b": "بروجيكتور",
    "\\bبروجكتورات\\b": "بروجيكتور",
    "\\bبروجكتورين\\b": "اتنين بروجيكتور",
    "\\bانحاس\\b": "نحاس",
    "\\bخلاط حود\\b": "خلاط حوض",
    "\\bخلاطات حود\\b": "خلاط حوض",
    "\\bخلاط حوض\\b": "خلاط حوض",
    "\\bخلاطات حوض\\b": "خلاط حوض",
    "\\bخلاطين حوض\\b": "اتنين خلاط حوض",
    "\\bطاستين\\b": "اتنين طاسة",
    "\\bطاسات\\b": "طاسة",
    "\\bطاسة\\b": "طاسة",
    "\\bطفاية حريق\\b": "طفاية حريق",
    "\\bطفايات حريق\\b": "طفاية حريق",
    "\\bطفايتين حريق\\b": "اتنين طفاية حريق",
    "\\bحديد\\b": "حديد",
    "\\bنجفة\\b": "نجفة",
    "\\bنجف\\b": "نجفة",
    "\\bنجفتين\\b": "اتنين نجفة",
    "\\bمجفف ملابس\\b": "مجفف ملابس",
    "\\bمجففات ملابس\\b": "مجفف ملابس",
    "\\bمجففين ملابس\\b": "اتنين مجفف ملابس",
    "\\bباب المنتج\\b": "باب المنتج",
    "\\bابواب المنتج\\b": "باب المنتج",
    "\\bبابين المنتج\\b": "اتنين باب المنتج",
    "\\bكروت صوت\\b": "كارت صوت",
    "\\bكارتين صوت\\b": "اتنين كارت صوت",
    "\\bكاميرات ويب\\b": "كاميرا ويب",
    "\\bكاميرتين ويب\\b": "اتنين كاميرا ويب",
    "\\bهاردات ديسك\\b": "هارد ديسك",
    "\\bهاردين ديسك\\b": "اتنين هارد ديسك",
    "\\bهوفر بورتات\\b": "هوفر بورت",
    "\\bهوفر بورتين\\b": "اتنين هوفر بورت",
    "\\bراديوهات\\b": "راديو",
    "\\bراديوين\\b": "اتنين راديو",
    "\\bايبودات\\b": "ايبود",
    "\\bايبودين\\b": "اتنين ايبود",
    "\\bبروجيكتورات\\b": "بروجيكتور",
    "\\bبروجيكتورين\\b": "اتنين بروجيكتور",
    "\\bماي فاي\\b": "ماي فاي",
    "\\bماي فايين\\b": "اتنين ماي فاي",
    "\\bباور بانكات\\b": "باور بانك",
    "\\bباور بانكين\\b": "اتنين باور بانك",
    "\\bبلايستيشن 2\\b": "بلايستيشن 2",
    "\\bكراسي\\b": "كرسي",
    "\\bكرسيين\\b": "اتنين كرسي",
    "\\bاتنين كرسي\\b": "اتنين كرسي",
    "\\بلاستيكات\\b": "بلاستيك",
    "\\bبلاستيكين\\b": "اتنين بلاستيك",
    "\\bاتنين بلاستيك\\b": "اتنين بلاستيك",
    "\\bكولمانات مياه\\b": "كولمان مياه",
    "\\bكولمانين مياه\\b": "اتنين كولمان مياه",
    "\\bاتنين كولمان مياه\\b": "اتنين كولمان مياه",
    "\\bكولمان\\b": "كولمان مياه",
    "\\bكولمانات\\b": "كولمان مياه",
    "\\bكولمانين\\b": "اتنين كولمان مياه",
    "\\bبراميل بلاستيك\\b": "برميل بلاستيك",
    "\\bبرميلين بلاستيك\\b": "اتنين برميل بلاستيك",
    "\\bاتنين برميل بلاستيك\\b": "اتنين برميل بلاستيك",
    "\\bأكريليكات\\b": "أكريليك",
    "\\bأكريليكين\\b": "اتنين أكريليك",
    "\\bاتنين أكريليك\\b": "اتنين أكريليك",
    "\\bكتب\\b": "كتاب",
    "\\bكتابين\\b": "اتنين كتاب",
    "\\bاتنين كتاب\\b": "اتنين كتاب",
    "\\bجرايد\\b": "جريدة",
    "\\bجريدتين\\b": "اتنين جريدة",
    "\\bاتنين جريدة\\b": "اتنين جريدة",
    "\\bكرتونات\\b": "كرتون",
    "\\bكرتونتين\\b": "اتنين كرتون",
    "\\bاتنين كرتون\\b": "اتنين كرتون",
    "\\bمجلات\\b": "مجلة",
    "\\bمجليتين\\b": "اتنين مجلة",
    "\\bاتنين مجلة\\b": "اتنين مجلة",
    "\\bاوراق\\b": "ورق",
    "\\bورقتين\\b": "اتنين ورق",
    "\\bاتنين ورق\\b": "اتنين ورق",
    "\\bورق متقطع\\b": "ورق متقطع",
    "\\bورق متقطعة\\b": "ورق متقطع",
    "\\bورق متقطعين\\b": "اتنين ورق متقطع",
    "\\bموبايلات\\b": "موبايل",
    "\\bموبايلين\\b": "اتنين موبايل",
    "\\bاتنين موبايل\\b": "اتنين موبايل",
    "\\bلابتوبات\\b": "لابتوب",
    "\\bلابتوبين\\b": "اتنين لابتوب",
    "\\bاتنين لابتوب\\b": "اتنين لابتوب",
    "\\bراوترات\\b": "راوتر",
    "\\bراوترين\\b": "اتنين راوتر",
    "\\bاتنين راوتر\\b": "اتنين راوتر",
    "\\bشاشات كمبيوتر قديمة\\b": "شاشة كمبيوتر قديمة",
    "\\bشاشتين كمبيوتر قديمة\\b": "اتنين شاشة كمبيوتر قديمة",
    "\\bاتنين شاشة كمبيوتر قديمة\\b": "اتنين شاشة كمبيوتر قديمة",
    "\\بروسيسورات كمبيوتر\\b": "بروسيسور كمبيوتر",
    "\\بروسيسورين كمبيوتر\\b": "اتنين بروسيسور كمبيوتر",
    "\\بروسيسورين\\b": "اتنين بروسيسور",
    "\\بروسيسورات\\b": "بروسيسور",
    "\\bاتنين بروسيسور كمبيوتر\\b": "اتنين بروسيسور كمبيوتر",
    "\\bريسيفرات\\b": "ريسيفر",
    "\\bريسيفرين\\b": "اتنين ريسيفر",
    "\\bاتنين ريسيفر\\b": "اتنين ريسيفر",
    "\\bتابلتات\\b": "تابلت",
    "\\bتابلتين\\b": "اتنين تابلت",
    "\\bاتنين تابلت\\b": "اتنين تابلت",
    "\\bبطاريات لابتوب\\b": "بطارية لابتوب",
    "\\bبطاريتين لابتوب\\b": "اتنين بطارية لابتوب",
    "\\bاتنين بطارية لابتوب\\b": "اتنين بطارية لابتوب",
    "\\bطابعات\\b": "طابعة",
    "\\bطابعتين\\b": "اتنين طابعة",
    "\\bاتنين طابعة\\b": "اتنين طابعة",
    "\\bطبعة\\b": "طابعة",
    "\\bطبعات\\b": "طابعة",
    "\\bطبعتين\\b": "طابعة",
    "\\bماكينة طباعة\\b": "__PRINTING_MACHINE__",
    "\\bمكينة طباعة\\b": "__PRINTING_MACHINE__",
    "\\bماكينات طباعة\\b": "__PRINTING_MACHINE__",
    "\\bماكينتين طباعة\\b": "__PRINTING_MACHINE__",
    "\\bمكين الطباعة\\b": "__PRINTING_MACHINE__",
    "\\bمكينات طباعة\\b": "__PRINTING_MACHINE__",
    "\\bصب ووفرات\\b": "صب ووفر",
    "\\bصب ووفرين\\b": "اتنين صب ووفر",
    "\\bاتنين صب ووفر\\b": "اتنين صب ووفر",
    "\\bرامات\\b": "رامات",
    "\\bرامتين\\b": "اتنين رامات",
    "\\bاتنين رامات\\b": "اتنين رامات",
    "\\bباور سبلايات\\b": "باور سبلاي",
    "\\bباور سبلايين\\b": "اتنين باور سبلاي",
    "\\bاتنين باور سبلاي\\b": "اتنين باور سبلاي",
    "\\bكروت شاشة\\b": "كارت شاشة",
    "\\bكارتين شاشة\\b": "اتنين كارت شاشة",
    "\\bاتنين كارت شاشة\\b": "اتنين كارت شاشة",
    "\\bمازر بورد لابتوب\\b": "مازر بورد لابتوب",
    "\\bمازر بورد موبايل\\b": "مازر بورد موبايل",
    "\\bمازر بوردات\\b": "مازر بورد",
    "\\bمازر بورد\\b": "مازر بورد",
    "\\bباور سبلاي\\b": "power supply",
    "\\bصب ووفر\\b": "subwoofer",
    "\\bمراوح\\b": "مروحة",
    "\\bمروحتين\\b": "اتنين مروحة",
    "\\bمروحة كمبيوتر\\b": "مروحة كمبيوتر",
    "\\bمراوح كمبيوتر\\b": "مروحة كمبيوتر",
    "\\bبروسيسور\\b": "processor",
    "\\bبروسيسورات\\b": "processor",
    // Add iron variants and transcription error corrections
    "\\bمكوى\\b": "مكواة",
    "\\bمكوة\\b": "مكواة",
    "\\bمكوية\\b": "مكواة",
    "\\bمكواه\\b": "مكواة",
    "\\bمكواة\\b": "مكواة",
    "\\bمكاوي\\b": "مكواة",
    "\\bمكاويين\\b": "اتنين مكواة",
    "\\bمكوايين\\b": "اتنين مكواة",
    "\\bمكوات\\b": "مكواة",
    "\\bمكوتين\\b": "اتنين مكواة",
    "\\bمكوين\\b": "اتنين مكواة",
  };

  for (const [pattern, replacement] of Object.entries(variants)) {
    text = text.replace(new RegExp(pattern, "g"), replacement);
  }

    text = text.replace(/__PRINTING_MACHINE__/g, "ماكينة طباعة");

  return text;
}

// Add new function to handle transcription error corrections
export function fixTranscriptionErrors(text: string): string {
  const errorCorrections: Record<string, string> = {
    // Common misheard words - exact matches first
    "\\bradio كاسيت\\b": "كرسي", // Common confusion
    "\\bراديو كاسيت\\b": "كرسي",
    "\\bكاسيت راديو\\b": "كرسي",
    "\\bراديو\\b": "كرسي", // Sometimes radio is confused with chair
    "\\bكاسيت\\b": "كرسي",
    "\\bاديو كاسيت\\b": "كرسي",
    "\\bديو كاسيت\\b": "كرسي",
    
    // Paper/cardboard confusions
    "\\bرقم قطع\\b": "ورق متقطع",
    "\\bرقم قطعة\\b": "ورق متقطع",
    "\\bرقم قطعتين\\b": "ورق متقطع",
    "\\bرقم قتع\\b": "ورق متقطع",
    "\\bرقم قتعة\\b": "ورق متقطع",
    "\\bورق قطع\\b": "ورق متقطع",
    "\\bورق قطعة\\b": "ورق متقطع",
    "\\bورق قتع\\b": "ورق متقطع",
    "\\bكردون\\b": "كرتون",
    "\\bكردونة\\b": "كرتون",
    "\\bكردونات\\b": "كرتون",
    
    // Metal confusions
    "\\bحديدة\\b": "حديد",
    "\\bحديدات\\b": "حديد",
    
    // Plastic confusions
    "\\bبلاستيكة\\b": "بلاستيك",
    "\\bبلاستيكات\\b": "بلاستيك",
    
    // Iron appliance confusions
    "\\bمكوى\\b": "مكواة",
    "\\bمكوة\\b": "مكواة",
    "\\bمكوية\\b": "مكواة",
    "\\bمكواه\\b": "مكواة",
    "\\bمكوات\\b": "مكواة",
    "\\bمكوتين\\b": "اتنين مكواة",
    "\\bمكوين\\b": "اتنين مكواة",
    "\\bمكاويين\\b": "اتنين مكواة",
    "\\bمكواتين\\b": "اتنين مكواة",
    
    // Chair confusions
    "\\bكرسية\\b": "كرسي",
    "\\bكرسيات\\b": "كرسي",
    "\\bكرسيتين\\b": "اتنين كرسي",
    "\\bكرسيين\\b": "اتنين كرسي",
    
    // Coleman water confusions
    "\\bكولمان\\b": "كولمان مياه",
    "\\bكولمانة\\b": "كولمان مياه",
    "\\bكولمانين\\b": "اتنين كولمان مياه",
    "\\bكولمانات\\b": "كولمان مياه",
    
    // Common OCR/transcription errors
    "\\bرقم\\b": "ورق", // Number vs paper confusion
    "\\bقطع\\b": "قطع", // Pieces - keep as is
    "\\bقتع\\b": "قطع", // Typo correction
    "\\bقطعة\\b": "قطعة", // Piece - keep as is
    "\\bقتعة\\b": "قطعة", // Typo correction
    
    // Specific pattern for the reported issue
    "\\b5 كراسي\\b": "5 كرسي",
    "\\b3 مكوى\\b": "3 مكواة",
    "\\b4 كولمان\\b": "4 كولمان مياه",
    "\\b0.5 كيلو رقم قطع\\b": "0.5 كيلو ورق متقطع",
    
    // Fan variations
    "\\bمراوحة\\b": "مروحة",
    "\\bمراوح\\b": "مروحة",
    "\\bمراوحين\\b": "اتنين مروحة",
    "\\bمراوحتين\\b": "اتنين مروحة",
    
    // Water knob variations
    "\\bمقبض مياه\\b": "مقبض مياه",
    "\\bمقابض مياه\\b": "مقبض مياه",
    "\\bمقبضين مياه\\b": "اتنين مقبض مياه",
    
    // Internet cable variations
    "\\bكابل إنترنت\\b": "كابل إنترنت",
    "\\bكابلات إنترنت\\b": "كابل إنترنت",
    "\\bكابلين إنترنت\\b": "اتنين كابل إنترنت",
    "\\bكيبل إنترنت\\b": "كابل إنترنت",
    "\\bكيبلات إنترنت\\b": "كابل إنترنت",
    
    // Gas heater variations
    "\\bسخان غاز\\b": "سخان غاز 10 لتر",
    "\\bسخانات غاز\\b": "سخان غاز 10 لتر",
    "\\bسخانين غاز\\b": "اتنين سخان غاز 10 لتر",
    
    // Tefal pot variations
    "\\bحلة فال\\b": "حلة تيفال",
    "\\bحلة تيفال\\b": "حلة تيفال",
    "\\bحلل فال\\b": "حلة تيفال",
    "\\bحلل تيفال\\b": "حلة تيفال",
    "\\bحلتين فال\\b": "اتنين حلة تيفال",
    "\\bحلتين تيفال\\b": "اتنين حلة تيفال",
    
    // Washing machine filter (transcription error for "filter")
    "\\bمطر غسالة\\b": "قاعدة غسالة", // Map to washing machine base as closest match
    "\\bمطر الغسالة\\b": "قاعدة غسالة",
    "\\bمطرات غسالة\\b": "قاعدة غسالة",
    "\\bمطرين غسالة\\b": "اتنين قاعدة غسالة",
    "\\bفلتر غسالة\\b": "قاعدة غسالة", // Map to washing machine base as closest match
    "\\bفلتر الغسالة\\b": "قاعدة غسالة",
    "\\bفلاتر غسالة\\b": "قاعدة غسالة",
    // Common Arabic phrases that should be removed
    "\\bأنا عندي\\b": "",
    "\\bعندي\\b": "",
    "\\bعندى\\b": "",
    "\\bمعي\\b": "",
    "\\bمعى\\b": "",
    "\\bفي\\b": "",
    "\\bفى\\b": "",
  };

  for (const [pattern, replacement] of Object.entries(errorCorrections)) {
    text = text.replace(new RegExp(pattern, "gi"), replacement);
  }
  
  // Remove punctuation and clean up spaces
  text = text.replace(/[،,;:.!?()]/g, " ");
  text = text.replace(/\s+/g, " ");
  text = text.trim();
  
  return text;
}
